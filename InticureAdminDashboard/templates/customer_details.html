{% extends 'base.html' %}
{% block content %}
<div class="nk-content ">
    <div class="container-fluid">
        <div class="nk-content-inner">
            <div class="nk-content-body">
                <div class="nk-block-head nk-block-head-sm">
                    <div class="nk-block-between g-3">
                        <div class="nk-block-head-content">
                            <h3 class="nk-block-title page-title">Customer Details {#<strong
                                    class="text-primary small">Abu Bin Ishtiyak</strong>#}</h3>
                            <div class="nk-block-des text-soft">
                                <ul class="list-inline">
                                    <li>User ID: <span class="text-base">{{profile2.user_id}}</span></li>
                                    {#<li>Last Login: <span class="text-base">15 Feb, 2019 01:02 PM</span></li>#}
                                </ul>
                            </div>
                        </div>
                        <div class="nk-block-head-content">
                            <a href="{{url_for('customers')}}"
                                class="btn btn-outline-light bg-white d-none d-sm-inline-flex"><em
                                    class="icon ni ni-arrow-left"></em><span>Back</span></a>
                            <a href="html/user-list-regular.html"
                                class="btn btn-icon btn-outline-light bg-white d-inline-flex d-sm-none"><em
                                    class="icon ni ni-arrow-left"></em></a>
                        </div>
                    </div>
                </div><!-- .nk-block-head -->
                <div class="nk-block">
                    <div class="card">
                        <div class="card-aside-wrap">
                            <div class="card-content">
                                <ul class="nav nav-tabs nav-tabs-mb-icon nav-tabs-card">
                                    <li class="nav-item">
                                        <a class="nav-link active" data-toggle="tab" href="#personal_info"><em
                                                class="icon ni ni-user-circle"></em><span>Personal</span></a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" data-toggle="tab" href="#appointments"><em
                                                class="icon ni ni-server"></em><span>Appointments</span></a>
                                    </li>
                                    {#<li class="nav-item">
                                        <a class="nav-link" data-toggle="tab" href="#transactions"><em
                                                class="icon ni ni-repeat"></em><span>Transactions</span></a>
                                    </li>#}
                                    <li class="nav-item">
                                        <a class="nav-link" data-toggle="tab" href="#invoices"><em
                                                class="icon ni ni-file-text"></em><span>Invoices</span></a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" data-toggle="tab" href="#appointmentscreate">
                                            <em class="icon ni ni-calendar-check"></em>
                                            <span>Appointments</span>
                                        </a>
                                    </li>

                                    {#<li class="nav-item">
                                        <a class="nav-link" data-toggle="tab" href="#payment_status"><em
                                                class="icon ni ni-money"></em><span>Payment
                                                Status</span></a>
                                    </li>#}
                                    <!-- <li class="nav-item">
                                        <a class="nav-link" href="#"><em class="icon ni ni-activity"></em><span>Activities</span></a>
                                    </li> -->
                                    <!-- <li class="nav-item nav-item-trigger d-xxl-none">
                                        <a href="#" class="toggle btn btn-icon btn-trigger" data-target="userAside"><em class="icon ni ni-user-list-fill"></em></a>
                                    </li> -->
                                </ul><!-- .nav-tabs -->

                                <!-- ################################### TAB CONTENT @S ############################################ -->
                                <div class="tab-content">
                                    <div class="tab-pane active" id="personal_info">
                                        <div class="card-inner">
                                    <div class="nk-block">
                                        {#<div class="nk-block-head">#}
                                            {#<h5 class="title">Personal Information</h5>#}
                                            {#<p>Basic info, like your name and address, that you use on Nio Platform.</p>#}
                                        {#</div>#}
                                        <div class="d-flex mb-3 " style="margin-left:55px ;">
                                            <h5 class="title mr-auto">
                                                {#Patient Information#}
                                                {% if profile1.first_name %}
                                                    {{profile1.first_name}} {{profile1.last_name}}
                                                {% else %}
                                                    Not Available
                                                {% endif %}
                                            </h5>
                                            
                                            
                                            <!--<div class="dropdown">
                                                <a class="text-soft dropdown-toggle btn btn-icon btn-trigger" data-toggle="dropdown"><em class="icon ni ni-more-v-alt"></em></a>
                                                <div class="dropdown-menu dropdown-menu-right dropdown-menu-xs">
                                                    <ul class="link-list-plain">
                                                        {#<li><a href="">View</a></li>#}
                                                        <li><a {#href="{{url_for('update_doctor',doctor_id=doctor_profile2.user_id)}}"#}>Edit</a></li>
                                                        {#<li><a href="#">Edit</a></li>#}
                                                        {#<li><a href="#">Remove</a></li>#}
                                                    </ul>
                                                </div>
                                            </div>-->
                                        </div>   
                                        <!-- .nk-block-head -->
                                        <div class="profile-ud-list" style="margin-left: 5px;">
                                            
                                            <div class="profile-ud-item">
                                                <div class="profile-ud wider">
                                                    <span class="profile-ud-label">Date of Birth</span>
                                                    <span class="profile-ud-value">
                                                    {% if profile2.date_of_birth %}
                                                    {{profile2.date_of_birth|date_format}}
                                                    {% else %}
                                                    Not Available
                                                    {% endif %}
                                                    </span>
                                                </div>
                                            </div>
                                            
                                            <div class="profile-ud-item">
                                                <div class="profile-ud wider">
                                                    <span class="profile-ud-label">Gender</span>
                                                    <span class="profile-ud-value">{{profile2.gender|capitalize}}</span>
                                                </div>
                                            </div>
                                            <div class="profile-ud-item">
                                                <div class="profile-ud wider">
                                                    <span class="profile-ud-label">Mobile Number</span>
                                                    <span class="profile-ud-value">
                                                        {% if profile2.mobile_number %}
                                                        {{profile2.mobile_number}}
                                                        {% else %}
                                                        Not Available
                                                        {% endif %}
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="profile-ud-item">
                                                <div class="profile-ud wider">
                                                    <span class="profile-ud-label">Email Address</span>
                                                    <span class="profile-ud-value">{{profile1.email}}</span>
                                                </div>
                                            </div>
                                            {#
                                            <div class="profile-ud-item">
                                                <div class="profile-ud wider">
                                                    <span class="profile-ud-label">Language Preferred</span>
                                                    <span class="profile-ud-value">{{language_known}}</span>
                                                </div>
                                            </div>
                                            <div class="profile-ud-item">
                                                <div class="profile-ud wider">
                                                    <span class="profile-ud-label">Gender Preferred</span>
                                                    <span class="profile-ud-value">{{language_known}}</span>
                                                </div>
                                            </div>
                                            <div class="profile-ud-item">
                                                <div class="profile-ud wider">
                                                    <span class="profile-ud-label">Location</span>
                                                    <span class="profile-ud-value">{{profile2.location}}</span>
                                                </div>
                                            </div>
                                            #}
                                        </div><!-- .profile-ud-list -->
                                    </div><!-- .nk-block -->
                                
                                    <div class="nk-block">
                                        {#
                                        <div class="nk-block-head nk-block-head-line">
                                            <h6 class="title overline-title text-base">Additional Information</h6>
                                        </div><!-- .nk-block-head -->
                                        #}
                                        <div class="profile-ud-list">
                                            {#
                                            <div class="profile-ud-item">
                                                <div class="profile-ud wider">
                                                    <span class="profile-ud-label">Joining Date</span>
                                                    <span class="profile-ud-value">08-16-2018 09:04PM</span>
                                                </div>
                                            </div>
                                            #}
                                            {#
                                            <div class="profile-ud-item">
                                                <div class="profile-ud wider">
                                                    <span class="profile-ud-label">Email</span>
                                                    <span class="profile-ud-value">Email</span>
                                                </div>
                                            </div>
                                            <div class="profile-ud-item">
                                                <div class="profile-ud wider">
                                                    <span class="profile-ud-label">Country</span>
                                                    <span class="profile-ud-value">United State</span>
                                                </div>
                                            </div>
                                            <div class="profile-ud-item">
                                                <div class="profile-ud wider">
                                                    <span class="profile-ud-label">Nationality</span>
                                                    <span class="profile-ud-value">United State</span>
                                                </div>
                                            </div>
                                            #}
                                        </div><!-- .profile-ud-list -->
                                    </div><!-- .nk-block -->
                                    {#
                                    <div class="nk-divider divider md"></div>
                                    <div class="nk-block">
                                        <div class="nk-block-head nk-block-head-sm nk-block-between">
                                            <h5 class="title">Admin Note</h5>
                                            <a href="#" class="link link-sm">+ Add Note</a>
                                        </div><!-- .nk-block-head -->
                                        <div class="bq-note">
                                            <div class="bq-note-item">
                                                <div class="bq-note-text">
                                                    <p>Aproin at metus et dolor tincidunt feugiat eu id quam. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Aenean sollicitudin non nunc vel pharetra. </p>
                                                </div>
                                                <div class="bq-note-meta">
                                                    <span class="bq-note-added">Added on <span class="date">November 18, 2019</span> at <span class="time">5:34 PM</span></span>
                                                    <span class="bq-note-sep sep">|</span>
                                                    <span class="bq-note-by">By <span>Softnio</span></span>
                                                    <a href="#" class="link link-sm link-danger">Delete Note</a>
                                                </div>
                                            </div><!-- .bq-note-item -->
                                            <div class="bq-note-item">
                                                <div class="bq-note-text">
                                                    <p>Aproin at metus et dolor tincidunt feugiat eu id quam. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Aenean sollicitudin non nunc vel pharetra. </p>
                                                </div>
                                                <div class="bq-note-meta">
                                                    <span class="bq-note-added">Added on <span class="date">November 18, 2019</span> at <span class="time">5:34 PM</span></span>
                                                    <span class="bq-note-sep sep">|</span>
                                                    <span class="bq-note-by">By <span>Softnio</span></span>
                                                    <a href="#" class="link link-sm link-danger">Delete Note</a>
                                                </div>
                                            </div><!-- .bq-note-item -->
                                        </div><!-- .bq-note -->
                                    </div><!-- .nk-block -->
                                    #}
                                </div>

                                    </div>
                                    <!-- ##################### CUSTOMER INFO TAB END ####################### -->
                                    <div class="tab-pane fade" id="appointmentscreate">

                                        <div >
                                            <div role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">Book a Senior Specialist </h5>
                                                        
                                                    </div>
                                                    <div class="modal-body">
                                                        <form action="" method="POST" class="form-validate is-alter" novalidate="novalidate">
                                                            <input type="hidden" id="form_type" name="form_type" value="escalate">
                                                            
                                                            <div class="container">
                                                                <div class="row">
                                                            
                                                            <div class="container col-sm-6">
                                                                <!-- <div class="row g-4"> -->

                                                            <input type = "hidden" id = "doctor_user_id" name = "doctor_user_id" value="" />

                                                                    <!-- <div class="col-md-6"> -->
                                                            <div class="form-group">
                                                                <label class="form-label" for="category">Select Category</label>
                                                                <div class="form-control-wrap ">
                                                                    <div class="form-control-select">
                                                                        <select class="form-control" id="category" name="category" onchange="doctorList('category')" required>
                                                                            <option value="">Select Category</option>
                                                                            {% for category in categories %}
                                                                            <option value="{{category.id}}">{{category.title}} </option>
                                                                            {% endfor %}

                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label class="form-label" for="specialization">Select Specialization</label>
                                                                <div class="form-control-wrap ">
                                                                    <div class="form-control-select">
                                                                        <select class="form-control" id="specialization" name="specialization" onchange="doctorList('specialization')" required>
                                                                            <option value="">Select Specialization</option>
                                                                            {% for specialization in specializations %}
                                                                            <option value="{{specialization.specialization}}">{{specialization.specialization|capitalize}} </option>
                                                                            {% endfor %}

                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <label class="form-label">Select preferred gender</label>  
                                                            <div class="g-4 align-center flex-wrap" style="padding-bottom:15px ;">
                                                                    
                                                                <div class="g">
                                                                    <div class="custom-control custom-radio">
                                                                        <input type="radio" class="custom-control-input" name="doc_gender" id="male" value="male" onchange="doctorList('gender')">
                                                                        <label class="custom-control-label lead" for="male">Male</label>
                                                                    </div>
                                                                </div>
                                                                <div class="g">
                                                                    <div class="custom-control custom-radio">
                                                                        <input type="radio" class="custom-control-input" name="doc_gender" id="female" value="female" onchange="doctorList('gender')">
                                                                        <label class="custom-control-label lead" for="female">Female</label>
                                                                    </div>
                                                                </div>
                                                                <div class="g">
                                                                    <div class="custom-control custom-radio">
                                                                        <input type="radio" class="custom-control-input" name="doc_gender" id="any_gender" value="" onchange="doctorList('gender')">
                                                                        <label class="custom-control-label lead" for="any_gender">Any Gender</label>
                                                                    </div>
                                                                </div>
                                                                
                                                            </div>
                                                        
                                                        <div class="form-group">
                                                                <label class="form-label">Session Type</label>
                                                                <div class="form-control-wrap">
                                                                    <select class="form-select form-control " id="session_type" name="session_type" onchange="doctorList('session_type')" required>
                                                                        <option value="">Select</option>
                                                                        <option value="individual">Individual</option>                                                                              
                                                                        <option value="couple">Couple</option>                                                                              
                                                                    </select>
                                                                </div>
                                                            </div>

                                                            <div class="form-group">
                                                                <label class="form-label">Language Preferred</label>
                                                                <div class="form-control-wrap">
                                                                    <select class="form-select form-control" id="language" name="language" onchange="doctorList('language')" required>
                                                                        <option value="">Select</option>
                                                                        {% for language in languages %}
                                                                        <option value="{{language.language}}">{{language.language}}</option>                                                                              
                                                                        {% endfor %}
                                                                    </select>
                                                                </div>
                                                            </div>

                                                        
                                                        </div>   
                                                        <div>
                                                            <p id="no_time_slot">
                                                            </p>
                                                        </div>
                                                        <!-- second column s -->
                                                        <div class="container col-lg-6">
                                                    
                                                            <label class="form-label" style="margin-left:35px ; display: none;" id="time_label">Select preferred time</label>  
                                                            <div class="boxed" style="overflow-y:scroll; height: 300px;padding-top:5px;" >
                                                                <div class="g-4 " style="margin-top: 0px;" id="time_box" >
                                                                    <div class="g m-auto">
                                                                        <p style="margin-top:100px ;">
                                                                            Available time slots will appear here
                                                                        </p>
                                                                    </div>
                                                                
                                                                </div>
                                                                <table class="table custom-table" style="border: none !important;border-collapse: collapse;">
                                                                    <input type="hidden" id="appointment_date" name="appointment_date" value="">
                                                                    <thead style="border: 0 !important">
                                                                        <tr id="t_head" class="text-center" style="color:black;font-family:Manrope ;font-weight:400;font-size: 13px;border: 0 !important">
                                                                            <th></th>
                                                                        </tr>
                                                                    </thead> 
                                                                    <tbody style="border: 0 !important">
                                                                        <tr id="t_row" class="text-center" style="color:black;font-family:Manrope ;font-weight:400;font-size: 13px;border: 0 !important">
                                                                            <td>
                                                                                
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>

                                                        </div>
                                            <!-- second column e -->
                                                                </div>
                                                                <div style="margin-top:20px ;">
                                                                <div class="form-group">
                                                                    <button type="submit" class="btn btn-md btn-mw btn-primary" id="refer_btn">Refer</button>
                                                                    {#<a type="button" href="{{url_for('action_doctor',actions=2,appointment_id=appointment_details.appointment_id)}}" class="btn btn-md btn-dark">Escalate </a>#}
                                                                    <button class="btn btn-md btn-mw btn-outline-primary" data-dismiss="modal">Cancel</button>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>









                                                
                                            </div>
                                                    <div id="doctorCardContainer" class="card-container rounded-lg" style="color:black;font-family:Manrope ;background-color:white; font-size:15px;width:400px;"></div>
                                        </div>
                                        </div>


                                    </div>

                                    <!-- ##################### APPOINTMENTS TAB @S   ####################### -->
                                    <div class="tab-pane " id="appointments">
                                        <div class="card-inner">
                                            <div class="nk-block">
                                                <div class="nk-block-head">
                                                    <h5 class="title">Appointments</h5>
                                                    {#<p>Basic info, like your name and address, that you use on Nio
                                                        Platform.</p>#}
                                                </div><!-- .nk-block-head -->

                                                <!-- table -->
                                                <div class="card card-preview">
                                                    <div class="card-inner">
                                                        {#<div class="card-title">#}
                                                            
                                                        {#</div>#}
                                                        <div id="DataTables_Table_0_wrapper" class="dataTables_wrapper dt-bootstrap4 no-footer">
                                                            <!-- <div class="row justify-between g-2">
                                                                <div class="col-7 col-sm-6 text-left">
                                                                    <div id="DataTables_Table_0_filter" class="dataTables_filter"><label><input type="search"
                                                                                class="form-control form-control-sm" placeholder="Type in to Search"
                                                                                aria-controls="DataTables_Table_0"></label></div>
                                                                </div>
                                                                <div class="col-5 col-sm-6 text-right">
                                                                    <div class="datatable-filter">
                                                                        <div class="dataTables_length" id="DataTables_Table_0_length"><label><span
                                                                                    class="d-none d-sm-inline-block">Show</span>
                                                                                <div class="form-control-select"> <select name="DataTables_Table_0_length"
                                                                                        aria-controls="DataTables_Table_0"
                                                                                        class="custom-select custom-select-sm form-control form-control-sm">
                                                                                        <option value="10">10</option>
                                                                                        <option value="25">25</option>
                                                                                        <option value="50">50</option>
                                                                                        <option value="100">100</option>
                                                                                    </select> </div>
                                                                            </label></div>
                                                                    </div>
                                                                </div>
                                                            </div> -->
                                                            <!-- <div class="datatable-wrap my-3"> -->
                                                                <table class="datatable-init table dataTable no-footer dtr-inline" id="DataTables_Table_0"
                                                                    role="grid" aria-describedby="DataTables_Table_0_info">
                                                                    <thead>
                                                                        <tr role="row" class="tb-tnx-head">
                                                                            <th>#</th>
                                                                            <th >Consultation For</th>
                                                                            <th >Consult. Date</th>
                                                                            <th >Consult. Time</th>
                                                                            <!-- <th >Consulting Doctor
                                                                            </th> -->
                                                                            <th>Status</th>
                                                                            <th></th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        {% for order in appointment_list %}
                                                                        <tr class="tb-tnx-item">
                                                                            <td>
                                                                                <a href="{{url_for('appointment_details',appointment_id=order.appointment_id)}}"><span>#{{order.appointment_id}}</span></a>
                                                                            </td>
                                                                            <td>                                                
                                                                                <span>
                                                                                    {{order.category}}                                                       
                                                                                </span>
                                                                            </td>
                                                                            <td>                                                                                                    
                                                                                    <span >{{order.appointment_date}}</span>                                                
                                                                            </td>
                                                                            <td>                                                
                                                                                <span >{{order.appointment_time_slot_id}}</span>                                            
                                                                            </td>
                                                                            <!-- <td>    
                                                                                    <span >{#{{order.consulting_doctor}}#}</span>                                                
                                                                            </td> -->
                                                                            <td>                                               
                                                                                {% if order.appointment_status==0 %}
                                                                                <span class="badge badge-dot badge-dot-xs badge-info">New</span>
                                                                                {% elif order.appointment_status==1 %}
                                                                                <span class="badge badge-dot badge-dot-xs badge-success">Accepted</span>
                                                                                {% elif order.appointment_status==2 %}
                                                                                <span class="badge badge-dot badge-dot-xs badge-primary">Escalated</span>
                                                                                {% elif order.appointment_status==3 %}
                                                                                <span class="badge badge-dot badge-dot-xs badge-danger">Cancelled</span>
                                                                                {% elif order.appointment_status==4 %}
                                                                                <span class="badge badge-dot badge-dot-xs badge-warning">Reschedule requested by doctor</span>
                                                                                {% elif order.appointment_status==5 %}
                                                                                <span class="badge badge-dot badge-dot-xs badge-gray">Reschedule request sent to doctor</span>
                                                                                {% elif order.appointment_status==6 %}
                                                                                <span class="badge badge-dot badge-dot-xs badge-secondary">Closed</span>
                                                                                {% elif order.appointment_status == 7 %}
                                                                                <span class="badge badge-dot badge-dot-xs badge-primary">Rescheduled</span>
                                                                                {% elif order.appointment_status == 8 %}
                                                                                <span class="badge badge-dot badge-dot-xs badge-info">Follow Up</span>
                                                                                {% elif order.appointment_status == 9 %}
                                                                                <span class="badge badge-dot badge-dot-xs badge-danger">No Show</span>
                                                                                {% elif order.appointment_status == 10 %}
                                                                                <span class="badge badge-dot badge-dot-xs badge-danger">Transfered</span>
                                                                                {% endif %}                                               
                                                                            </td>
                                                                            <td class="tb-tnx-action">
                                                                                <div class="dropdown">
                                                                                    <a class="text-soft dropdown-toggle btn btn-icon btn-trigger" data-toggle="dropdown"><em class="icon ni ni-more-h"></em></a>
                                                                                    <div class="dropdown-menu dropdown-menu-right dropdown-menu-xs">
                                                                                        <ul class="link-list-plain">
                                                                                            <li><a href="{{url_for('appointment_details',appointment_id=order.appointment_id)}}">View</a></li>
                                                                                            {#<li><a href="#">Edit</a></li>#}
                                                                                            {#<li><a href="#">Remove</a></li>#}
                                                                                        </ul>
                                                                                    </div>
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                        {% endfor %}
                                                                        
                                                                        
                                                                    </tbody>
                                                                </table>
                                                            <!-- </div> -->
                                                            <!-- <div class="row align-items-center">
                                                                <div class="col-7 col-sm-12 col-md-9">
                                                                    <div class="dataTables_paginate paging_simple_numbers" id="DataTables_Table_0_paginate">
                                                                        <ul class="pagination">
                                                                            <li class="paginate_button page-item previous disabled"
                                                                                id="DataTables_Table_0_previous"><a href="#" aria-controls="DataTables_Table_0"
                                                                                    data-dt-idx="0" tabindex="0" class="page-link">Prev</a></li>
                                                                            <li class="paginate_button page-item active"><a href="#"
                                                                                    aria-controls="DataTables_Table_0" data-dt-idx="1" tabindex="0"
                                                                                    class="page-link">1</a></li>
                                                                            <li class="paginate_button page-item "><a href="#" aria-controls="DataTables_Table_0"
                                                                                    data-dt-idx="2" tabindex="0" class="page-link">2</a></li>
                                                                            <li class="paginate_button page-item "><a href="#" aria-controls="DataTables_Table_0"
                                                                                    data-dt-idx="3" tabindex="0" class="page-link">3</a></li>
                                                                            <li class="paginate_button page-item "><a href="#" aria-controls="DataTables_Table_0"
                                                                                    data-dt-idx="4" tabindex="0" class="page-link">4</a></li>
                                                                            <li class="paginate_button page-item "><a href="#" aria-controls="DataTables_Table_0"
                                                                                    data-dt-idx="5" tabindex="0" class="page-link">5</a></li>
                                                                            <li class="paginate_button page-item disabled" id="DataTables_Table_0_ellipsis"><a
                                                                                    href="#" aria-controls="DataTables_Table_0" data-dt-idx="6" tabindex="0"
                                                                                    class="page-link">…</a></li>
                                                                            <li class="paginate_button page-item "><a href="#" aria-controls="DataTables_Table_0"
                                                                                    data-dt-idx="7" tabindex="0" class="page-link">12</a></li>
                                                                            <li class="paginate_button page-item next" id="DataTables_Table_0_next"><a href="#"
                                                                                    aria-controls="DataTables_Table_0" data-dt-idx="8" tabindex="0"
                                                                                    class="page-link">Next</a></li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                                <div class="col-5 col-sm-12 col-md-3 text-left text-md-right">
                                                                    <div class="dataTables_info" id="DataTables_Table_0_info" role="status" aria-live="polite">1 -10
                                                                        of 120</div>
                                                                </div>
                                                            </div> -->
                                                        </div>
                                                    </div>
                                                </div><!-- .card-preview -->
                                                <!-- table @e -->

                                            </div><!-- .nk-block -->
                                        </div>
                                    </div>
                                    <!-- ########################### APPOINTMENTS TAB END ############################## -->

                                    <!-- ############################### TRANSACTIONS TAB @S #########################  -->
                                    <div class="tab-pane " id="transactions">
                                        <div class="card-inner">
                                            <div class="nk-block">
                                                <div class="nk-block-head">
                                                    <h5 class="title">Transactions</h5>
                                                    <p>Basic info, like your name and address, that you use on Nio
                                                        Platform.</p>
                                                </div><!-- .nk-block-head -->
                                            </div><!-- .nk-block -->
                                        </div>
                                    </div>
                                    <!-- ############################### TRANSACTIONS TAB @E #########################  -->

                                    <!-- ############################### INVOICES TAB @S #########################  -->
                                    <div class="tab-pane " id="invoices">
                                        <div class="card-inner">
                                            <div class="nk-block">
                                                <div class="nk-block-head">
                                                    <h5 class="title">Invoices</h5>
                                                    <!-- <p>Basic info, like your name and address, that you use on Nio
                                                        Platform.</p> -->
                                                        <!-- Invoices tabs start -->
                                                        <div class="nk-block">
                                                            <div class="card card-bordered">
                                                                <div class="card-aside-wrap">
                                                                    <div class="card-content">
                                                                        <ul class="nav nav-tabs nav-tabs-mb-icon nav-tabs-card">
                                                                            <li class="nav-item">
                                                                                <a class="nav-link active" href="#upcoming" data-toggle="tab"><span>Upcoming</span></a>
                                                                            </li>
                                                                            <li class="nav-item">
                                                                                <a class="nav-link" href="#paid" data-toggle="tab"><span>Paid</span></a>
                                                                            </li>
                                                                            
                                                                            <!-- <li class="nav-item">
                                                                                <a class="nav-link" href="#" data-toggle="tab"><span>Documents</span></a>
                                                                            </li> -->
                                                                            <!-- <li class="nav-item">
                                                                                <a class="nav-link" href="#" data-toggle="tab"><span>Notifications</span></a>
                                                                            </li> -->
                                                                            <!-- <li class="nav-item">
                                                                                <a class="nav-link" href="#" data-toggle="tab"><span>Activities</span></a>
                                                                            </li> -->
                                                                            <!-- <li class="nav-item nav-item-trigger d-xxl-none">
                                                                                <a href="#" class="toggle btn btn-icon btn-trigger" data-target="userAside"><em class="icon ni ni-user-list-fill"></em></a>
                                                                            </li> -->
                                                                        </ul><!-- .nav-tabs -->
                                                                        <div class="tab-content">
                                                                            <!-- upcoming tab content @s -->
                                                                            <div class="tab-pane active" id="upcoming">
                                                                                <div class="card-inner">
                                                                                    <div class="nk-block">
                                                                                        <div class="nk-block-head">
                                                                                            <h5 class="title ml-4">Appointments To Be Paid</h5>
                                                                                            {#<p>Basic info, like your name and address, that you use on Nio
                                                                                                Platform.</p>#}
                                                                                        </div><!-- .nk-block-head -->
                                                                                    </div><!-- .nk-block -->
                                                                                    
                                                                                    <!-- <div class="nk-block nk-block-lg">
                                                                                    <div class="nk-block-head">
                                                                                        <div class="nk-block-head-content">
                                                                                            <h4 class="nk-block-title">Data Table</h4>
                                                                                            <div class="nk-block-des">
                                                                                                <p>Using the most basic table markup, here’s how <code class="code-class">.table</code> based tables look by default.</p>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div> -->
                                                                                    <div class="card card-preview">
                                                                                        <div class="card-inner">
                                                                                            <table class="datatable-init table" data-ordering="false">
                                                                                                <thead>
                                                                                                    <tr>
                                                                                                        <th>Appointment Id</th>
                                                                                                        <th>Appointment Date</th>
                                                                                                        <th>Service</th>
                                                                                                        <th>Due Date</th>
                                                                                                        <th>Status</th>
                                                                                                        <th>Total</th>
                                                                                                        <th></th>
                                                                                                    </tr>
                                                                                                </thead>
                                                                                                <tbody>
                                                                                                    {% for invoice in unpaid_invoices %}
                                                                                                    <tr>
                                                                                                        <td><a href="{{url_for('invoice_details',invoice_id=invoice.invoice_id)}}">{{invoice.appointment_id}}</a></td>
                                                                                                        <td>
                                                                                                            {% if invoice.appointment_date %}
                                                                                                            {{invoice.appointment_date|date_format}}
                                                                                                            {% else %}
                                                                                                            Not Available
                                                                                                            {% endif %}
                                                                                                        </td>
                                                                                                        <td>
                                                                                                            {% if invoice.appointment_date %}
                                                                                                            {{invoice.service}}
                                                                                                            {% else %}
                                                                                                            Not Available
                                                                                                            {% endif %}
                                                                                                        </td>
                                                                                                        <td>{{invoice.due_date|date_format}}</td>
                                                                                                        <td>
                                                                                                            {% if invoice.status == 1 %}
                                                                                                            <span class="tb-status text-success">Paid</span>
                                                                                                            {% elif invoice.status == 2 %}
                                                                                                            <span class="tb-status text-warning">Pending</span>
                                                                                                            {% elif invoice.status == 0 %}
                                                                                                            Not Applicable
                                                                                                            {% endif %}
                                                                                                        </td>
                                                                                                        <td>{{invoice.total}} {{invoice.currency}}</td>
                                                                                                        <td class="tb-tnx-action">
                                                                                                            <div class="dropdown">
                                                                                                                <a class="text-soft dropdown-toggle btn btn-icon btn-trigger" data-toggle="dropdown"><em class="icon ni ni-more-v"></em></a>
                                                                                                                <div class="dropdown-menu dropdown-menu-right dropdown-menu-xs">
                                                                                                                    <ul class="link-list-plain">
                                                                                                                        <li><a href="{{url_for('invoice_details',invoice_id=invoice.invoice_id)}}">Pay</a></li>
                                                                                                                        {#<li><a href="#">Edit</a></li>#}
                                                                                                                        {#<li><a href="#">Remove</a></li>#}
                                                                                                                    </ul>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                    {% endfor %}
                                                                                                        
                                                                                                    
                                                                                                </tbody>
                                                                                            </table>
                                                                                        </div>
                                                                                    </div><!-- .card-preview -->
                                                                                </div> <!-- nk-block -->
                                                                                    
                                                                                </div>
                                                                            
                                                                            <!-- upcoming tab content @e -->
                                        
                                                                            <!-- paid tab content @s -->
                                                                            <div class="tab-pane" id="paid">
                                                                                <div class="card-inner">
                                                                                    <div class="nk-block">
                                                                                        <div class="nk-block-head">
                                                                                            <h5 class="title ml-4">Paid Appointments</h5>
                                                                                            {#<p>Basic info, like your name and address, that you use on Nio
                                                                                                Platform.</p>#}
                                                                                        </div><!-- .nk-block-head -->
                                                                                    </div><!-- .nk-block -->
                                                                                    
                                                                                    <!-- <div class="nk-block nk-block-lg">
                                                                                    <div class="nk-block-head">
                                                                                        <div class="nk-block-head-content">
                                                                                            <h4 class="nk-block-title">Data Table</h4>
                                                                                            <div class="nk-block-des">
                                                                                                <p>Using the most basic table markup, here’s how <code class="code-class">.table</code> based tables look by default.</p>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div> -->
                                                                                    <div class="card card-preview">
                                                                                        <div class="card-inner">
                                                                                            <table class="datatable-init table" data-ordering="false">
                                                                                                <thead>
                                                                                                    <tr>
                                                                                                        <th>Appointment Id</th>
                                                                                                        <th>Appointment Date</th>
                                                                                                        <th>Service</th>
                                                                                                        <th>Due Date</th>
                                                                                                        <th>Status</th>
                                                                                                        <th>Total</th>
                                                                                                        <th></th>
                                                                                                    </tr>
                                                                                                </thead>
                                                                                                <tbody>
                                                                                                    {% for invoice in paid_invoices %}
                                                                                                    <tr>
                                                                                                        <td><a href="{{url_for('invoice_details',invoice_id=invoice.invoice_id)}}">{{invoice.appointment_id}}</a></td>
                                                                                                        <td>
                                                                                                            {% if invoice.appointment_date %}
                                                                                                            {{invoice.appointment_date|date_format}}
                                                                                                            {% else %}
                                                                                                            Not Available
                                                                                                            {% endif %}
                                                                                                        </td>
                                                                                                        <td>
                                                                                                            {% if invoice.appointment_date %}
                                                                                                            {{invoice.service}}
                                                                                                            {% else %}
                                                                                                            Not Available
                                                                                                            {% endif %}
                                                                                                        </td>
                                                                                                        <td>{{invoice.due_date|date_format}}</td>
                                                                                                        <td>
                                                                                                            {% if invoice.status == 1 %}
                                                                                                            <span class="tb-status text-success">Paid</span>
                                                                                                            {% elif invoice.status == 2 %}
                                                                                                            <span class="tb-status text-warning">Pending</span>
                                                                                                            {% elif invoice.status == 0 %}
                                                                                                            Not Applicable
                                                                                                            {% endif %}
                                                                                                        </td>
                                                                                                        <td>{{invoice.total}} {{invoice.currency}}</td>
                                                                                                        <td class="tb-tnx-action">
                                                                                                            <div class="dropdown">
                                                                                                                <a class="text-soft dropdown-toggle btn btn-icon btn-trigger" data-toggle="dropdown"><em class="icon ni ni-more-v"></em></a>
                                                                                                                <div class="dropdown-menu dropdown-menu-right dropdown-menu-xs">
                                                                                                                    <ul class="link-list-plain">
                                                                                                                        <li><a href="{{url_for('invoice_details',invoice_id=invoice.invoice_id)}}">View Invoice</a></li>
                                                                                                                        {#<li><a href="#">Edit</a></li>#}
                                                                                                                        {#<li><a href="#">Remove</a></li>#}
                                                                                                                    </ul>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                    {% endfor %}
                                                                                                    
                                                                                                    
                                                                                                </tbody>
                                                                                            </table>
                                                                                        </div>
                                                                                    </div><!-- .card-preview -->
                                                                                </div> <!-- nk-block -->
                                                                                </div>
                                                                            <!-- paid tab content @e -->
                                        
                                                                            
                                                                                <!-- </div> -->
                                                                                <!-- tab content end -->
                                                                        </div>
                                                                    </div>
                                        
                                                                </div>
                                                            </div><!-- .card -->
                                                        </div><!-- .nk-block -->
                                                        <!-- Invoices tabs end -->
                                                </div><!-- .nk-block-head -->
                                            </div><!-- .nk-block -->
                                        </div>
                                    </div>
                                    <!-- ############################### INVOICES TAB @E #########################  -->

                                    



                                    <!-- ############################### PAYMENT STATUS TAB @S #########################  -->
                                    <div class="tab-pane " id="payment_status">
                                        <div class="card-inner">
                                            <div class="nk-block">
                                                <div class="nk-block-head">
                                                    <h5 class="title">Payment Status</h5>
                                                    <p>Basic info, like your name and address, that you use on Nio
                                                        Platform.</p>
                                                </div><!-- .nk-block-head -->
                                            </div><!-- .nk-block -->
                                        </div>
                                    </div>
                                    <!-- ############################### PAYMENT STATUS TAB @E #########################  -->

                                    <!-- ################################### TAB CONTENT @E ############################################ -->
                                    



                                </div><!-- .card-content -->

                               
                                
                            </div><!-- .card-aside-wrap -->
                        </div><!-- .card -->
                    </div><!-- .nk-block -->
                    
                </div>
            </div>
        </div>
        
    </div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script>src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script>
$(document).ready(function(){
  $("#refer_btn").click(function(){
    var timeElement = $("input[name='appointment_time_1']:checked");
    var hid_el = timeElement.closest('div').find('input[type="hidden"]');
    console.log(hid_el);
    
    if (hid_el.length > 0) {
    var date = hid_el.val();
    console.log(date);
    $("input[name='appointment_date']").val(date);
    } else {
        console.log("No hidden input found.");
    }
  });
});
</script>
    <script>
const handleTimeSlotClick = async (radio) => {

    // Get the selected time slot value
    var selectedTimeSlot = radio.value;

    // Optionally, get the associated date value
    var dateId = radio.id.replace('time', 'date'); // Derive the ID of the hidden input
    var selectedDate = document.getElementById(dateId).value;
    var session_type = document.getElementById('session_type').value
    var language = document.getElementById('language').value
    var gender_pref = document.querySelector('input[name = "doc_gender"]:checked').value
    var specialization = document.getElementById('specialization').value;
    // Perform your custom action
    console.log("Selected Time Slot:", selectedTimeSlot);
    console.log("Selected Date:", selectedDate);
    let [startTime, endTime] = selectedTimeSlot.split(" - ");
    const payload = {   
        date: selectedDate,
        time_slot: startTime,
        end_time: endTime,
        user_email: "{{profile1.user_mail}}",
        specialization: specialization,
        session_type: session_type,
        language: language,
        gender: gender_pref,
        country:"{{profile2.residence_location}}",
    };

    await fetch("https://api.inticure.online/api/doctor/timeslots", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': '{{ csrf_token }}'  // Include CSRF token if you're using Django
            },
            body: JSON.stringify(payload)
        })
        .then(response => response.json())
        .then(data => {
            const doctorCardContainer = document.getElementById('doctorCardContainer');
            doctorCardContainer.innerHTML = createDoctorCard(data['data']);
            console.log('Response from the new request:', data['data']);
        })
        .catch((error) => {
            console.error('Error:', error);
        });
    
    }
    function createDoctorCard(doctor) {
        console.log(doctor)
        document.getElementById('doctor_user_id').value = doctor.doctor_user_id;
        return `
            <div class="card p-5 rounded-lg" style="width:300px;background-color: transparent">
                <h4>${doctor.fullname}</h4>
                <p class="price">${doctor.price} <span class="currency">${doctor.currency}</span></p>
                <p><strong>Specialization:</strong> ${doctor.specialization}</p>
                <p><strong>Bio:</strong> ${doctor.bio}</p>
            </div>
        `;
    }
</script>
<script>

const doctorList= async(dat) =>{
    console.log(dat)
    var load={}; 
   
        var specialization = document.getElementById('specialization').value
        load.specialization=specialization
       
    
        var language_pref = document.getElementById('language').value
        load.language_pref=language_pref
        var gender_pref = document.querySelector('input[name = "doc_gender"]:checked').value;
        load.gender=gender_pref
        var session_type = document.getElementById('session_type').value;
        load.session_type=session_type
        var location = "{{profile2.residence_location}}"
        load.location=location
        let elements = document.getElementsByName("appointment_time_1");
        if (elements.length){
            console.log("appointment time element exists")
            time_label=document.getElementById("time_label")
            time_label.style.display = "block";
            if(document.querySelectorAll('input[name = "appointment_time_1"]:checked').length == 0){
            console.log('None of the checkboxes are checked');
            }else{
            var appointment_time = document.querySelector('input[name = "appointment_time_1"]:checked').value;
            }
        }
        else{
            console.log("appointment time element not exist")
            appointment_time="";
        }
    console.log(specialization, language_pref, gender_pref,location)
    var doctor = 'senior';
    var appointment_id=""
    load.doctor_flag=doctor,
    load.appointment_id=appointment_id,
    console.log(load)

    const resp = await fetch("https://api.inticure.online/api/doctor/specialization_time_slot", {
        method: 'POST',
        body: JSON.stringify(load), // string or object
        headers: {
        'Content-Type': 'application/json',
        'Access-Control-Allow-Origin':'*',
        'Access-Control-Allow-Methods':'GET,POST,PUT,DELETE,PATCH,OPTIONS'
    }
    })
    const myTimeslot = await resp.json();
    console.log('myTimeslot2',myTimeslot);
    var time_slots=myTimeslot['slots']
    console.log(time_slots);
    var options="";

    if(myTimeslot.language_preferred === false && myTimeslot.gender_preferred === true){
        $('#no_time_slot').empty();
        no_time_slot = '<br></br><br></br><div class="g m-auto text-center"><p class="text-center">Unfortunately a doctor that matches your language preference is currently unavailable. But here are the time slots for another excellent doctor.</div>'
        $('#no_time_slot').append(no_time_slot);
    }else if(myTimeslot.language_preferred === true && myTimeslot.gender_preferred === false){
        $('#no_time_slot').empty();
        no_time_slot = '<br></br><br></br><div class="g m-auto text-center"><p class="text-center">Unfortunately a doctor that matches your gender preference is currently unavailable. But here are the time slots for another excellent doctor.</div>'
        $('#no_time_slot').append(no_time_slot);
    }else if(myTimeslot.language_preferred === false && myTimeslot.gender_preferred === false){
        $('#no_time_slot').empty();
        no_time_slot = '<br></br><br></br><div class="g m-auto text-center"><p class="text-center">Unfortunately a doctor that matches your preferences is currently unavailable. But here are the time slots for another excellent doctor.</div>'
        $('#no_time_slot').append(no_time_slot);
    }
    else{
        $('#no_time_slot').empty();
        no_time_slot = ''
        $('#no_time_slot').append(no_time_slot);
    }


    if (myTimeslot['message'] === 'No Doctors Available'){
        console.log("no time")
        var time_label=document.getElementById("time_label")
            time_label.style.display = "none";
        var no_time_slot="";
        var message=myTimeslot['message'];
        $('#time_box').empty();
        no_time_slot = '<br></br><br></br><div class="g m-auto"><p style="padding-top:50px;">Sorry.. No time slots available.</p><p>Please select a different date.</p></div>'
        $('#time_box').append(no_time_slot);
    }
    else{

    $('#time_box').empty();
    $('#t_head').empty();
    $('#t_row').empty();
    
    $.each(time_slots,function(index,value){    
    console.log(value);
    timeslots = value.timeslot;
    var input="";
    
    $.each(timeslots, function(i, ts) {
    var radioId = 'time' + index + '_' + i;
    var label = '<label for="' + radioId + '">' + ts.time_slot + " - " + ts.end_time + '</label>';
    var radioBtn = '<input type="radio" id="' + radioId + '" name="appointment_time_1" value="' + ts.time_slot + " - " + ts.end_time + '" onclick="handleTimeSlotClick(this)">';
    var hid = '<input type="hidden" id="date' + index + '_' + i + '" name="date" value="' + value.date + '">';
    var div = '<div><div class="custom-control custom-radio" style="margin-bottom:8px;">' + radioBtn + label + hid + '</div>' + '</div>';
    input += div;
});

    var input1='<th>'+ moment(value.date).format('DD MMM YYYY')+'</th>';
    $('#t_head').append(input1);
    var t=' <td>'+ input+'</td>';
    $('#t_row').append(t)
});

}
    console.log("My Time Slot",myTimeslot);
    return myTimeslot;

}

</script>
<style>
    .boxed label {
  display: inline-block;
  width: 150px;
  padding: 10px;
  font-size: 13px;
  /* border: solid 1px #ccc; */
  border: solid 1px #DBDFEA;
  transition: all 0.3s;
}

.boxed input[type="radio"] {
  display: none;
}

.boxed input[type="radio"]:checked + label {
  border: solid 2px #854FFF;
}
</style>

<style>
    table.custom-table {
        border-collapse: collapse;
    }

    table.custom-table td,
    table.custom-table th {
        border: none !important;
    }

    table.custom-table thead tr:first-child th {
        border-top: none !important;
    }

    table.custom-table thead tr:first-child th:last-child {
        border-right: none !important;
    }

    table.custom-table thead th:first-child {
        border-left: none !important;
    }

    table.custom-table thead th:last-child {
        border-right: none !important;
    }

    table.custom-table tbody td:first-child {
        border-left: none !important;
    }

    table.custom-table tbody td:last-child {
        border-right: none !important;
    }
</style>
{% endblock %}
